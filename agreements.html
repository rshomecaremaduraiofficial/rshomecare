<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RS Home Care â€“ Digital Agreement</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;margin:0;padding:0}

/* BODY */
body{
  font-family:'Poppins',sans-serif;
  color:#333;
  scroll-behavior:smooth;
  background:url('oldagecare-bg.jpg') no-repeat center center fixed;
  background-size:cover;
  position:relative;
}
body::before{
  content:"";
  position:fixed;
  inset:0;
  background:rgba(245,249,255,0.8);
  z-index:-1;
}

/* HEADER */
header{
  background:linear-gradient(135deg,#96ceff,#8cffbc);
  text-align:center;
  padding:60px 20px;
}
header img{max-width:140px;margin-bottom:15px}
header h1{font-size:2.8em;color:#243879}
header p{font-size:1.2em;margin-bottom:20px}
.cta{
  background:#fff;
  color:#0f4c81;
  padding:12px 28px;
  border-radius:30px;
  text-decoration:none;
  font-weight:600;
}

/* NAV */
nav{
  background:#fff;
  padding:15px;
  text-align:center;
  box-shadow:0 4px 10px rgba(0,0,0,0.08);
  position:sticky;
  top:0;
  z-index:2;
}

/* CONTAINER */
.container{
  max-width:720px;
  margin:50px auto;
  padding:0 15px;
}

/* HEADINGS */
h2{
  text-align:center;
  color:#0f4c81;
  margin-bottom:18px;
}

/* AGREEMENT SECTION */
.agreement-section{
  display:flex;
  justify-content:center;
  gap:20px;
  flex-wrap:wrap;
  margin:30px 0;
}

/* AGREEMENT CARD */
.card{
  background:#fff;
  padding:25px;
  border-radius:18px;
  margin:15px auto;
  box-shadow:0 15px 35px rgba(0,0,0,.08);
  animation:fadeUp .6s ease;
  max-width:420px;
  width:100%;
  text-align:center;
}

.agreement-section .card{
  max-width:320px;
}

.card h3{
  margin-bottom:15px;
  color:#0f4c81;
}

@keyframes fadeUp{
  from{opacity:0;transform:translateY(20px)}
  to{opacity:1;transform:none}
}

/* INPUTS */
input,textarea{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:1px solid #ccc;
  font-size:14px;
  margin-top:12px;
}

/* BUTTON */
button{
  padding:14px 28px;
  border:none;
  border-radius:30px;
  background:linear-gradient(135deg,#0f4c81,#2ecc71);
  color:#fff;
  font-weight:600;
  cursor:pointer;
  transition:.3s;
}
button:hover{
  transform:translateY(-2px);
  box-shadow:0 10px 25px rgba(0,0,0,.15);
}

/* FILE UPLOAD */
.file-wrap{
  margin-top:14px;
  position:relative;
  cursor:pointer;
}
.file-wrap input{
  opacity:0;
  position:absolute;
  inset:0;
}
.file-ui{
  padding:16px;
  border:2px dashed #0f4c81;
  border-radius:14px;
  text-align:center;
  color:#0f4c81;
  font-size:14px;
  pointer-events:none; /* IMPORTANT */
}

/* CHECKBOX (INLINE FIX) */
.checkbox{
  margin-top:18px;
  display:flex;
  align-items:center;
  justify-content:flex-start;
  gap:8px;
  font-size:14px;
}
.checkbox input{
  width:16px;
  height:16px;
  margin:0;
  cursor:pointer;
}

/* ERROR */
.error{
  color:#e74c3c;
  font-size:13px;
  display:none;
  text-align:center;
  margin-top:10px;
}

/* SIGNATURE */
.signature-box{
  margin-top:20px;
  border:2px dashed #2ecc71;
  border-radius:14px;
  padding:12px;
}
canvas{
  width:100%;
  height:160px;
  background:#fff;
  border-radius:12px;
  touch-action:none;
}
.clear-btn{
  margin-top:10px;
  background:#e74c3c;
}

/* MODAL */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999;
}
.modal-box{
  background:#fff;
  width:95%;
  max-width:900px;
  border-radius:16px;
  overflow:hidden;
}
.modal-header{
  background:#0f4c81;
  color:#fff;
  padding:12px;
  display:flex;
  align-items:center;
  gap:10px;
}
.modal-header span{
  flex:1;
  font-weight:600;
}
.modal-header button{
  padding:6px 14px;
  border-radius:8px;
  border:none;
  cursor:pointer;
  background:#2ecc71;
  color:#fff;
}
.modal-header .close{
  background:#e74c3c;
}
iframe{
  width:100%;
  height:75vh;
  border:none;
}

/* MOBILE */
@media(max-width:768px){
  header h1{font-size:2.2em}
  .agreement-section{
    flex-direction:column;
    align-items:center;
  }
}

</style>
</head>

<body>

  <header>
  <img src="logo.png">
  <h1>RS Home Care</h1>
  <p>Trusted Care â€¢ Comfort â€¢ Compassion</p>
</header>

<div class="container">

<h2>Service Agreements</h2>

<div class="agreement-section">

  <div class="card">
    <h3>Government Contract Form</h3>
    <button onclick="requestPassword(
      'Government Contract form final.pdf',
      'Government Contract Form'
    )">
      View Agreement
    </button>
  </div>

  <div class="card">
    <h3>RS Home Care English</h3>
    <button onclick="requestPassword(
      'RS Home Care English.pdf',
      'RS Home Care English'
    )">
      View Agreement
    </button>
  </div>

  <div class="card">
    <h3>RS Home Care Tamil</h3>
    <button onclick="requestPassword(
      'RS Home Care Tamil.pdf',
      'RS Home Care Tamil'
    )">
      View Agreement
    </button>
  </div>

</div>

<h2>Digital Agreement Submission</h2>

<div class="card">

<input id="name" name="name" placeholder="Full Name" required>

<input id="phone" name="phone" placeholder="Phone Number" required>

<textarea id="message" name="message" rows="4" placeholder="Message"></textarea>

<div class="file-wrap">
  <div class="file-ui" id="fileLabel">
    ðŸ“Ž Upload Image or PDF Agreement
  </div>
  <input 
    type="file" 
    id="doc"
    accept=".pdf,.jpg,.jpeg,.png"
    required
    onchange="showFileName(this)">
</div>

<div id="filePreview"
     style="margin-top:10px;font-size:14px;color:#0f4c81;"></div>

<div class="signature-box">
<p style="font-size:14px">Digital Signature</p>
<canvas id="signature"></canvas>
<button class="clear-btn" onclick="clearSignature()">Clear Signature</button>
</div>

<div class="checkbox">
<input type="checkbox" id="agree">
<label for="agree">I agree to the Service Agreement</label>
</div>

<div class="error" id="errorMsg">
Please agree and sign before submitting
</div>

<br>
<button onclick="submitForm()">Submit Agreement</button>

</div>
</div>
<div class="modal" id="pdfModal">
<div class="modal-box">
<div class="modal-header">
<span id="pdfTitle"></span>
<button onclick="downloadPDF()">Download</button>
<button class="close" onclick="closePDF()">âœ•</button>
</div>
<iframe id="pdfViewer"></iframe>
</div>
</div>

<script>
  (function(){
  const PAGE_PASSWORD = "RShomecarepage";

  if (sessionStorage.getItem("agreement_access") !== "true") {
    const pwd = prompt("ðŸ”’This websit has been protected by RS Home Care Enter Agreement Access Password:");
    if (pwd !== PAGE_PASSWORD) {
      alert("Access Denied");
      document.body.innerHTML = "";
      window.location.href = "/";
    } else {
      sessionStorage.setItem("agreement_access","true");
    }
  }
})();
const AGREEMENT_PASSWORD = "RShomecare";
let currentPDF = "";

/* ASK PASSWORD */
function requestPassword(file, title){
  const pwd = prompt("Enter agreement password:");
  if(pwd !== AGREEMENT_PASSWORD){
    alert("Incorrect password");
    return;
  }
  openPDF(file, title);
}

/* OPEN PDF */
function openPDF(file, title){
  currentPDF = file;
  document.getElementById("pdfViewer").src = file;
  document.getElementById("pdfTitle").innerText = title;
  document.getElementById("pdfModal").style.display = "flex";
}

/* DOWNLOAD */
function downloadPDF(){
  const a = document.createElement("a");
  a.href = currentPDF;
  a.download = currentPDF.split("/").pop();
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}

/* CLOSE */
function closePDF(){
  document.getElementById("pdfModal").style.display = "none";
  document.getElementById("pdfViewer").src = "";
}

/* SIGNATURE */
const canvas = document.getElementById("signature");
const ctx = canvas.getContext("2d");

let drawing = false;
let lastX = 0;
let lastY = 0;

/* High DPI support */
function resizeCanvas(){
  const ratio = window.devicePixelRatio || 1;
  const rect = canvas.getBoundingClientRect();
  canvas.width = rect.width * ratio;
  canvas.height = rect.height * ratio;
  ctx.scale(ratio, ratio);
  ctx.lineWidth = 2.5;
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  ctx.strokeStyle = "#000";
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

/* Get position */
function getPos(e){
  const rect = canvas.getBoundingClientRect();
  const touch = e.touches ? e.touches[0] : e;
  return {
    x: touch.clientX - rect.left,
    y: touch.clientY - rect.top
  };
}

/* Start drawing */
function start(e){
  drawing = true;
  const pos = getPos(e);
  lastX = pos.x;
  lastY = pos.y;
}

/* Draw smoothly */
function draw(e){
  if(!drawing) return;
  e.preventDefault();
  const pos = getPos(e);
  ctx.beginPath();
  ctx.moveTo(lastX, lastY);
  ctx.lineTo(pos.x, pos.y);
  ctx.stroke();
  lastX = pos.x;
  lastY = pos.y;
}

/* Stop */
function stop(){
  drawing = false;
}

canvas.addEventListener("mousedown", start);
canvas.addEventListener("mousemove", draw);
canvas.addEventListener("mouseup", stop);
canvas.addEventListener("mouseleave", stop);

canvas.addEventListener("touchstart", start, {passive:false});
canvas.addEventListener("touchmove", draw, {passive:false});
canvas.addEventListener("touchend", stop);

function clearSignature(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
}

function isSignatureEmpty(){
  const blank = document.createElement("canvas");
  blank.width = canvas.width;
  blank.height = canvas.height;
  return canvas.toDataURL() === blank.toDataURL();
}
function showFileName(input){
  const preview = document.getElementById("filePreview");
  const label = document.getElementById("fileLabel");

  if(!input.files || !input.files[0]){
    preview.innerHTML = "";
    label.innerText = "ðŸ“Ž Upload Image or PDF Agreement";
    return;
  }

  const file = input.files[0];
  label.innerText = "âœ” File Selected";

  // IMAGE PREVIEW
  if(file.type.startsWith("image/")){
    const reader = new FileReader();
    reader.onload = function(e){
      preview.innerHTML = `
        <strong>Selected Image:</strong> ${file.name}<br><br>
        <img src="${e.target.result}"
             style="max-width:100%;border-radius:12px;
             box-shadow:0 8px 20px rgba(0,0,0,.15)">
      `;
    };
    reader.readAsDataURL(file);
  }
  else{
    preview.innerHTML = `
      <strong>Selected File:</strong> ${file.name}
    `;
  }
}
/* SUBMIT */
function submitForm(){
  if(!agree.checked || !doc.files.length){
    errorMsg.style.display="block";
    errorMsg.innerText="Please agree and upload signed document";
    return;
  }

  errorMsg.style.display="none";

  canvas.toBlob(function(blob){
    const fd = new FormData();

   fd.append("name", document.getElementById("name").value);
   fd.append("phone", document.getElementById("phone").value);
   fd.append("message", document.getElementById("message").value);

    // REAL IMAGE FILE
    fd.append("Signature", blob, "signature.png");

    // Optional uploaded agreement
    if(doc.files[0]){
      fd.append("Agreement File", doc.files[0]);
    }

    fd.append("_subject", "New Digital Agreement â€“ RS Home Care");
    fd.append("_captcha", "false");

    fetch("https://formsubmit.co/rshomecaremaduraiofficial@gmail.com", {
      method: "POST",
      body: fd
    }).then(() => {
      alert("Agreement submitted successfully!");
      location.reload();
    });
  });
}
</script>

</body>
</html>
