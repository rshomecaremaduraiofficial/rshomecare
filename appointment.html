<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Book Appointment – RS Home Care</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="icon" type="image/png" href="logo.png">
<link rel="apple-touch-icon" href="logo.png">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:'Poppins',sans-serif;
  background:#f5f9ff;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:20px;
}
.appointment-box{
  background:#fff;
  width:100%;
  max-width:480px;
  padding:32px;
  border-radius:20px;
  box-shadow:0 15px 40px rgba(0,0,0,0.15);
}
.appointment-box img{
  max-width:120px;
  display:block;
  margin:0 auto 12px;
}
h2{
  text-align:center;
  color:#0f4c81;
  margin-bottom:22px;
}
.form-group{margin-bottom:16px}
input, textarea{
  width:100%;
  padding:14px;
  border-radius:12px;
  border:1px solid #ccc;
  font-size:14px;
}
textarea{resize:vertical;min-height:90px}
button{
  width:100%;
  padding:14px;
  background:#2ecc71;
  border:none;
  border-radius:30px;
  color:#fff;
  font-weight:600;
  cursor:pointer;
}
.time-note{
  font-size:12px;
  color:#555;
  margin-top:4px;
}
</style>
</head>

<body>

<div class="appointment-box">
  <img src="logo.png" alt="RS Home Care Logo">
  <h2>Book an Appointment</h2>

  <form id="appointmentForm">

    <div class="form-group">
      <input type="text" id="clientName" placeholder="Your Name" required>
    </div>

    <div class="form-group">
      <input type="email" id="clientEmail" placeholder="Your Email" required>
    </div>

    <div class="form-group">
      <input type="text" id="clientPhone" placeholder="Phone Number" required>
    </div>

    <div class="form-group">
      <input type="text" id="clientAddress" placeholder="Your Address" required>
    </div>

    <!-- ✅ Preferred Time -->
    <div class="form-group">
      <input type="time" id="preferredTime"
             min="10:00" max="18:00" required>
      <div class="time-note">Available time: 10:00 AM – 6:00 PM</div>
    </div>

    <div class="form-group">
      <textarea id="appointmentDetails"
        placeholder="What is this appointment about?" required></textarea>
    </div>

    <button type="submit">Submit Appointment</button>
  </form>
</div>

<script>
/* Generate numbers */
function genRef(){
  const d = new Date().toISOString().slice(0,10).replace(/-/g,"");
  const r = Math.random().toString(36).substring(2,7).toUpperCase();
  return `RS-${d}-${r}`;
}
function genAppt(){
  return `APT-${Math.floor(1000 + Math.random()*9000)}`;
}

document.getElementById("appointmentForm").addEventListener("submit", function(e){
  e.preventDefault();

  const name    = clientName.value.trim();
  const phone   = clientPhone.value.trim();
  const email   = clientEmail.value.trim();
  const address = clientAddress.value.trim();
  const details = appointmentDetails.value.trim();
  const time    = preferredTime.value;

  // ✅ Time validation
  if(time < "10:00" || time > "18:00"){
    alert("Please select a time between 10:00 AM and 6:00 PM");
    return;
  }

  const referenceNumber   = genRef();
  const appointmentNumber = genAppt();
  const appointmentStatus = "Confirmed";

  const dateStr = new Date().toLocaleDateString("en-GB",{
    day:"2-digit",month:"long",year:"numeric"
  });

  // Save locally
  const list = JSON.parse(localStorage.getItem("rs_appointments") || "[]");
  list.unshift({
    ref: referenceNumber,
    appt: appointmentNumber,
    status: appointmentStatus,
    name, phone, email, address,
    time, date: dateStr
  });
  localStorage.setItem("rs_appointments", JSON.stringify(list.slice(0,50)));

  // Save for thankyou / PDF
  sessionStorage.setItem("clientName", name);
  sessionStorage.setItem("clientPhone", phone);
  sessionStorage.setItem("clientEmail", email);
  sessionStorage.setItem("clientAddress", address);
  sessionStorage.setItem("preferredTime", time);
  sessionStorage.setItem("referenceNumber", referenceNumber);
  sessionStorage.setItem("appointmentNumber", appointmentNumber);
  sessionStorage.setItem("appointmentStatus", appointmentStatus);

  // Send email
  const fd = new FormData();
  fd.append("Appointment No", appointmentNumber);
  fd.append("Reference No", referenceNumber);
  fd.append("Status", appointmentStatus);
  fd.append("Preferred Time", time);

  fd.append("Client Name", name);
  fd.append("Client Email", email);
  fd.append("Client Phone", phone);
  fd.append("Client Address", address);
  fd.append("Appointment Details", details);

  fd.append("_captcha","false");
  fd.append("_subject",`New Appointment – ${appointmentNumber} (${referenceNumber})`);
  fd.append("_template","table");

  fetch("https://formsubmit.co/rshomecaremaduraiofficial@gmail.com", {
    method:"POST",
    body:fd
  }).then(()=>{
    window.location.href="thankyou.html";
  }).catch(()=>{
    alert("Submission failed. Please try again.");
  });
});
</script>

</body>
</html>
